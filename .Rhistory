facet_wrap(~detyear)
ggplot(ms, aes(x = detyear, y = factor(maxrkm_reached), color = detyear)) +
geom_sina()
ggplot(ms, aes(x = detyear, y = factor(maxrkm_reached), color = detyear)) +
geom_sina(size = 3)
ggplot(ms, aes(x = detyear, y = maxrkm_reached, color = detyear)) +
geom_sina(size = 3)
ggplot(ms, aes(x = detyear, y = maxrkm_reached, color = detyear)) +
geom_sina(size = 0.5)
ggplot(esc2, aes(x = species, y = count, fill = variable)) +
facet_wrap(~detyear, labeller = label_value) +
geom_rect(aes(fill = species), xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf, alpha = 0.2, show.legend = FALSE) +
geom_bar(stat = 'identity', color = "black") +
scale_fill_manual(values = c("#440154FF" , "white", "gray40", "#FDE725FF")) +
labs(y = "Count") +
theme(text = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5),
legend.position = "none")
esc2 <- filter(esc2, Sp == 'wst')
esc2 <- filter(esc2, species == 'wst')
ggplot(esc2)
ggplot(esc2, aes(x = species, y = count, fill = variable)) +
geom_bar(stat = 'identity')
head(esc2)
esc <- read.csv("data_tidy/escapement.csv", stringsAsFactors = FALSE, header = TRUE)
str(esc)
esc$detyear <- as.numeric(esc$detyear)
esc2 <- reshape2::melt(esc, id.vars = c("detyear", "species", "sample_size"), value.name = "count")
esc2 <- filter(esc2, detyear != 2011)
esc2$species <- factor(esc2$species, labels = c("Chinook salmon", "white sturgeon"))
esc <- read.csv("data_tidy/escapement.csv", stringsAsFactors = FALSE, header = TRUE)
esc$detyear <- as.numeric(esc$detyear)
esc2 <- reshape2::melt(esc, id.vars = c("detyear", "species", "sample_size"), value.name = "count")
head(esc2)
esc2 <- filter(esc2, species == 'wst')
ggplot(esc2, aes(x = species, y = count, fill = variable)) +
geom_bar(stat = 'identity')
ggplot(esc2, aes(x = species, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
facet_wrap(~detyear)
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip()
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
theme(element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
theme(element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year")
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year")
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
theme_minimal()
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggsave(filename = "figures/IEP/wst_exitsbyyear.jpg", width = 10, height = 5.5, units = "in")
library(tidyverse)
library(ybp)
library(fishtrackr)
library(lubridate)
library(viridis)
library(beepr)
knitr::opts_knit$set(root.dir = normalizePath(".."))
d <- all69khz_grouped
d$Date <- as.Date(d$DateTimeUTC)
d11 <- dplyr::filter(d, DateTimeUTC > "2011-07-01 00:00:00", DateTimeUTC < "2012-06-30 00:00:00") # start with 2012
d12 <- dplyr::filter(d, DateTimeUTC > "2012-07-01 00:00:00", DateTimeUTC < "2013-06-30 00:00:00")
d13 <- dplyr::filter(d, DateTimeUTC > "2013-07-01 00:00:00", DateTimeUTC < "2014-06-30 00:00:00")
d14 <- dplyr::filter(d, DateTimeUTC > "2014-07-01 00:00:00", DateTimeUTC < "2015-06-30 00:00:00")
d15 <- dplyr::filter(d, DateTimeUTC > "2015-07-01 00:00:00", DateTimeUTC < "2016-06-30 00:00:00")
d11$detyear <- "2011"
d12$detyear <- "2012"
d13$detyear <- "2013"
d14$detyear <- "2014"
d15$detyear <- "2015"
d2 <- rbind(d11, d12, d13, d14, d15, make.row.names = FALSE)
library(dplyr)
d2$day <- as.Date(d2$DateTimeUTC)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
ungroup()
densities <- d2 %>%
group_by(day, TagID) %>%
mutate(detcount = n()) # where n is the number of detections for that tagid on that day
densities <- d2 %>%
group_by(detyear, day, Sp) %>%
summarise(nfish = length(unique(TagID)))
densities
densmap <- densities
densmap <- transform(densmap,
week = as.POSIXlt(day)$yday %/% 7 + 1,
wday = as.POSIXlt(day)$wday,
year = as.POSIXlt(day)$year + 1900)
densmap2 <- filter(densmap, Sp == "wst")
p <- p + labs(title = "White Sturgeon Presence in the Yolo Bypass By Detection Year", x = "Week of the Year",
y = NULL) +
theme(axis.title.x = element_text(size = 12),
axis.text.y = element_blank(),
legend.title = element_text(size = 8),
axis.ticks.y = element_blank()) +
scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50), labels = c("Jan", "Mar", "May", "Jul", "Oct", "Dec"))
p <- ggplot(densmap2, aes(x = week, y = wday, fill = nfish)) +
geom_tile(colour = "white") +
scale_fill_viridis(breaks = c(1, 5, 10, 15, 20, 30, 40), option = "C") +
facet_wrap(~detyear, ncol = 1, labeller = label_value) +
guides(fill = guide_legend(title = "Number \nof \nIndividuals",
ncol = 1))
p <- p + labs(title = "White Sturgeon Presence in the Yolo Bypass By Detection Year", x = "Week of the Year",
y = NULL) +
theme(axis.title.x = element_text(size = 12),
axis.text.y = element_blank(),
legend.title = element_text(size = 8),
axis.ticks.y = element_blank()) +
scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50), labels = c("Jan", "Mar", "May", "Jul", "Oct", "Dec"))
p
p <- p + labs(title = "White Sturgeon Presence in the Yolo Bypass By Detection Year", x = "Week of the Year",
y = NULL) +
theme(axis.title.x = element_text(size = 12),
axis.text.y = element_blank(),
legend.title = element_text(size = 8),
axis.ticks.y = element_blank()) +
scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50), labels = c("Jan", "Mar", "May", "Jul", "Oct", "Dec"),
limits = c(1, 52))
p
p <- p + labs(title = "White Sturgeon Presence in the Yolo Bypass By Detection Year", x = "Week of the Year",
y = NULL) +
theme(axis.title.x = element_text(size = 12),
axis.text.y = element_blank(),
legend.title = element_text(size = 8),
axis.ticks.y = element_blank()) +
scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50), labels = c("Jan", "Mar", "May", "Jul", "Oct", "Dec"),
expand = c(0,0))
p
p <- p + labs(title = "White Sturgeon Presence in the Yolo Bypass By Detection Year", x = "Week of the Year",
y = "Weekday") +
theme(axis.title.x = element_text(size = 12),
axis.text.y = element_blank(),
legend.title = element_text(size = 8),
axis.ticks.y = element_blank()) +
scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50), labels = c("Jan", "Mar", "May", "Jul", "Oct", "Dec"),
expand = c(0,0))
p
ggsave(p, filename = "figures/IEP/calendarwst_plot.jpg", width = 10, height = 5.5, units = "in")
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guide_legend(title = NULL) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guide_legend(title = "") +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
esc <- read.csv("data_tidy/escapement.csv", stringsAsFactors = FALSE, header = TRUE)
str(esc)
esc$detyear <- as.numeric(esc$detyear)
esc2 <- reshape2::melt(esc, id.vars = c("detyear", "species", "sample_size"), value.name = "count")
esc2 <- filter(esc2, species == 'wst')
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guide_legend(title = "") +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = " ")) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = " ")) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = " ")) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
?legend.title
??guides
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity') +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable), guide_legend(title = NULL)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12)) +
scale_y_continuous(guides = guide_legend(title = NULL))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12)) +
scale_y_continuous(guide = guide_legend(title = NULL))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12)) +
scale_fill_continuous(guide = guide_legend(title = NULL))
ggplot(esc2, aes(x = detyear, y = count, fill = variable), guide_legend(title = NULL)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
guides(guide_legend(title = NULL)) +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12)) +
scale_fill_discrete(guide = guide_legend(title = NULL))
ggplot(esc2, aes(x = detyear, y = count, fill = variable)) +
geom_bar(stat = 'identity', aes(fill = variable)) +
coord_flip() +
#  scale_fill_viridis(discrete = TRUE) +
labs(x = "Detection Year", y = "Count", title = "White Sturgeon Exits from the Yolo Bypass by Year") +
theme_minimal() +
theme(text = element_text(size = 16),
axis.text = element_text(size = 12)) +
scale_fill_discrete(guide = guide_legend(title = NULL))
ggsave(filename = "figures/IEP/wst_exitsbyyear.jpg", width = 10, height = 5.5, units = "in")
head(maxrkms)
?split
g <- ms$TagID
comtags <- split(ms$detyear, g )
comtags
g <- ms$detyear
comtags <- split(ms$TagID, g )
comtags
Reduce(intersect, comtags)
?Reduce
coms <- Reduce(intersect, comtags)
coms <- filter(ms, TagID %in% coms)
head(coms)
ggplot(coms, aes(x = detyear, y = maxrkm_reached, group = factor(TagID))) +
geom_path()
ggplot(coms, aes(x = detyear, y = maxrkm_reached, group = 1)) +
geom_point() +
geom_path()
ggplot(coms, aes(x = detyear, y = maxrkm_reached, group = TagID)) +
geom_point() +
geom_path()
ggplot(coms, aes(x = detyear, y = maxrkm_reached, group = TagID)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID)))
ggplot(coms, aes(x = detyear, y = maxrkm_reached, group = TagID)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID))) +
facet_wrap(~factor(TagID))
ggplot(coms, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID))) +
facet_wrap(~factor(TagID))
ggplot(coms, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID))
ggplot(coms, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_grid(~factor(TagID))
ggplot(ms, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID), scales = 'free_x')
coms2 <- Reduce(intersect, comtags[1:3])
coms2 <- filter(ms, TagID %in% coms)
ggplot(coms2, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
theme(legend.position = 'none')
coms2 <- Reduce(intersect, comtags[1:3])
coms2 <- filter(ms, TagID %in% coms2)
ggplot(coms2, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
theme(legend.position = 'none')
coms1 <- Reduce(intersect, comtags[4:5])
coms1
coms345 <- Reduce(intersect, list(coms1, comtags[3]))
?intersect
coms345 <- intersect(coms1, comtags[3])
intersect(comtags[1], comtags[2])
Reduce(intersect, c(comtags[1], comtags[2]))
comtags[1][comtags[1] %in% comtags[2]]
comtags[1]
comtags[2]
Reduce(intersect, c(coms1, comtags[3]))
coms1
comtags[3]
str(comtags[3])
str(coms1)
Reduce(intersect, c(list(coms1), comtags[3]))
coms345 <- Reduce(intersect, c(list(coms1), comtags[3]))
coms2345 <- Reduce(intersect, c(list(coms345), comtags[2]))
chk <- Reduce(intersect, comtags[2:5])
identical(coms2345, chk)
coms2 <- Reduce(intersect, comtags[2:5])
coms2 <- filter(ms, TagID %in% coms2)
ggplot(coms2, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns')
ggplot(ms, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = 1)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none')
!(comtags[1] %in% comtags[2])
setdiff(comtags[1], comtags[2])
nope <- setdiff(comtags[1], comtags[2])
yup <- filter(ms, !(TagID %in% nope))
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = detyear)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none')
nope <- setdiff(comtags[1], comtags[2])
nope
(x <- c(sort(sample(1:20, 9)), NA))
(y <- c(sort(sample(3:23, 7)), NA))
union(x, y)
setdiff(x, y)
setequal()
setequal(x, y)
setdiff(y, x)
comtags
yup <- filter(ms, detyear != '2011 - 2012')
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = detyear)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none')
yup <- filter(ms, TagID %in% coms2)
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = TagID)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none') +
scale_x_discrete(labels = c("1", "2", "3", "4", "5"))
coms2 <- Reduce(intersect, comtags[2:5])
yup <- filter(ms, TagID %in% coms2)
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = TagID)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none') +
scale_x_discrete(labels = c("1", "2", "3", "4", "5"))
yup <- unlist(comtags[2:5])
yup
names(yup) <- NULL
yup <- yup[!duplicated(yup)]
yup <- filter(ms, TagID %in% yup)
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = TagID)) +
facet_wrap(~factor(TagID), scales = 'free_x') +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none') +
scale_x_discrete(labels = c("1", "2", "3", "4", "5"))
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = TagID)) +
facet_wrap(~factor(TagID)) +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none') +
scale_x_discrete(labels = c("1", "2", "3", "4", "5"))
pair_intersect <- outer(comtags, comtags, Vectorize(intersect))
pair_intersect
count <- matrix(lengths(pair_intersect), nrow = length(comtags),
dimnames = dimnames(pair_intersect))
count
?outer
outersect <- function(x, y) {
sort(c(setdiff(x, y),
setdiff(y, x)))
}
outersect(comtags, comtags)
outersect(comtags[1], comtags[3])
ms %>%
group_by(TagID, detyear) %>%
tally() %>%
filter(n == 1)
ms %>%
group_by(detyear, TagID) %>%
filter(!duplicated(TagID)) %>%
ungroup() %>%
group_by(TagID) %>%
tally() %>%
filter(n == 1)
ms %>%
group_by(detyear, TagID) %>%
filter(!duplicated(TagID)) %>%
ungroup() %>%
group_by(detyear) %>%
tally() %>%
filter(n == 1)
knitr::opts_chunk$set(echo = TRUE, fig.retina=2, message=FALSE)
summary(ms)
(load("wst_maxrkms.Rda"))
library(hrbrthemes) # github
library(devtools)
dput(comtags)
tt = table(unlist(comtags))
tt
oneFish = names(tt)[tt == 1]
oneFish
ans = lapply(comtags, function(x) {
x[!(x %in% oneFish)]
})
ans
sapply(comtags, length)
sapply(comtags, function(x) sum(!x %in% oneFish))
sapply(ans, length)
table(unlist(ans))
onefish <- as.numeric(oneFish)
yup <- filter(ms, !(TagID %in% onefish))
ggplot(yup, aes(x = detyear, y = maxrkm_reached)) +
geom_point(aes(color = factor(TagID))) +
geom_path(aes(color = factor(TagID), group = TagID)) +
facet_wrap(~factor(TagID)) +
labs(title = 'Maximum River Kilometer Reached in Consecutive Years of Returns') +
theme(legend.position = 'none') +
scale_x_discrete(labels = c("1", "2", "3", "4", "5"))
