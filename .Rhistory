geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1)
ggplot(densmap, aes(x = detyear, y = week, fill = nfish)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~Sp, ncol = 1)
ggplot(densmap, aes(x = detyear, y = nfish, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis(discrete = TRUE)
ggplot(densmap, aes(x = week, y = wday, fill = nfish)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1)
ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1)
head(densmap)
ggplot(densmap, aes(x = day, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1)
ggplot(densmap, aes(x = day, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow"))
ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1)
p <- ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1)
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday")
?theme
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank())
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
?facet_wrap
ggplot(densmap, aes(x = week, y = wday, fill = nfish)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1, labeller = label_value(labels = data.frame("2011-2012",
"2012-2013",
"2013-2014",
"2014-2015",
"2015-2016"
densmap$detyear <- factor(densmap$detyear, labels = c("2011-2012",
"2012-2013",
"2013-2014",
"2014-2015",
"2015-2016"))
ggplot(densmap, aes(x = week, y = wday, fill = nfish)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1, labeller = label_value() )
ggplot(densmap, aes(x = week, y = wday, fill = nfish)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1, labeller = label_value )
p <- ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1, labeller = label_value)
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
densmap <- densities
densmap <- transform(densmap,
week = as.POSIXlt(day)$yday %/% 7 + 1,
wday = as.POSIXlt(day)$wday,
year = as.POSIXlt(day)$year + 1900)
densmap$detyear <- factor(densmap$detyear, labels = c("2011-2012",
"2012-2013",
"2013-2014",
"2014-2015",
"2015-2016"))
p <- ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1, labeller = label_value)
p
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
head(d2)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
ungroup()
densities <- d2 %>%
group_by(detyear, day, Sp) %>%
summarise(nfish = length(unique(TagID)))
densmap <- densities
densmap <- transform(densmap,
week = as.POSIXlt(day)$yday %/% 7 + 1,
wday = as.POSIXlt(day)$wday,
year = as.POSIXlt(day)$year + 1900)
densmap$detyear <- factor(densmap$detyear, labels = c("2011-2012",
"2012-2013",
"2013-2014",
"2014-2015",
"2015-2016"))
p <- ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1, labeller = label_value)
p
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggplot(densmap, aes(x = week, y = wday, group = Sp, fill = nfish)) +
geom_tile(aes(color = Sp), colour = "white", alpha = 0.6) +
#  scale_fill_viridis() +
facet_wrap(~detyear, ncol = 1, labeller = label_value )
p <- ggplot(densmap, aes(x = week, y = wday, fill = Sp)) +
geom_tile(colour = "white", alpha = 0.6) +
scale_fill_manual(values = c("blue", "yellow")) +
facet_wrap(~detyear, ncol = 1, labeller = label_value)
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
p + labs(title = "Presence in the Yolo Bypass By Species and Detection Year", x = " ",
y = "Weekday") + theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
a <- alltags
groups <- split(a, a$`Tagging Group`)
g <- map(groups, select, TagID) # selects only the TagID column of each dataframe
tags <- unlist(g, recursive = FALSE) # have to unlist the first level to be able to manipulate with these as vectors
d <- all69khz_grouped # all detections, with grouped gated receivers
# we'll do white sturgeon first
d3 <- filter(d, TagID %in% tags$wst_2012.TagID | TagID %in% tags$wst_2014.TagID) # contains all the detections for both tagging groups of white sturgeon - still have to filter further by year to get residence
d3 <- d3 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
arrange(DateTimeUTC)  # make sure we don't get any detections for individual fish before they were tagged
library(ybp)
library(fishtrackr)
library(tidyverse)
a <- alltags
groups <- split(a, a$`Tagging Group`)
g <- map(groups, select, TagID) # selects only the TagID column of each dataframe
tags <- unlist(g, recursive = FALSE) # have to unlist the first level to be able to manipulate with these as vectors
d <- all69khz_grouped # all detections, with grouped gated receivers
# we'll do white sturgeon first
d3 <- filter(d, TagID %in% tags$wst_2012.TagID | TagID %in% tags$wst_2014.TagID) # contains all the detections for both tagging groups of white sturgeon - still have to filter further by year to get residence
d3 <- d3 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
arrange(DateTimeUTC)  # make sure we don't get any detections for individual fish before they were tagged
# White sturgeon residence in detyear 2011 (which includes only the spring of 2012)---------
wst11 <- d3 %>%
filter(DateTimeUTC > "2011-06-01 00:00:00", DateTimeUTC < '2012-05-31 23:59:59') # keep in mind that this is all in UTC still
fp_wst11 <- fishpaths(wst11, wst11$TagID, wst11$Station)
fp_wst11 <- fp_wst11 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_wst11$residence) <- "days"
fp_wst11 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_wst11 <- fp_wst11 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_wst11$totalres) <- "days"
firstlast_wst11$tagging_group <- "wst11"
meanres_wst11 <- firstlast_wst11 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID)) # works; move to new script to complete calculations
meanres_wst11
# White sturgeon residence in 2012------------------
wst12 <- d3 %>%
filter(DateTimeUTC > "2012-06-01 00:00:00", DateTimeUTC < '2013-05-31 23:59:59') # keep in mind that this is all in UTC still
fp_wst12 <- fishpaths(wst12, wst12$TagID, wst12$Station)
fp_wst12 <- fp_wst12 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_wst12$residence) <- "days"
fp_wst12 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_wst12 <- fp_wst12 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_wst12$totalres) <- "days"
firstlast_wst12$tagging_group <- "wst12"
meanres_wst12 <- firstlast_wst12 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID)) # works; move to new script to complete calculations
meanres_wst12
# White sturgeon residence in 2013:-----------------
wst13 <- d3 %>%
filter(DateTimeUTC > "2013-06-01 00:00:00", DateTimeUTC < '2014-05-31 23:59:59')
wst13 <- filter(wst13,  !(TagID %in% tags$wst_2014.TagID)) # Only run this line for the plot; it filters out the fish tagged that spring
fp_wst13 <- fishpaths(wst13, wst13$TagID, wst13$Station)
fp_wst13 <- fp_wst13 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_wst13$residence) <- "days"
fp_wst13 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_wst13 <- fp_wst13 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_wst13$totalres) <- "days"
firstlast_wst13$tagging_group <- "wst13"
meanres_wst13 <- firstlast_wst13 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID)) # works; move to new script to complete calculations
meanres_wst13
wst14 <- d3 %>%
filter(DateTimeUTC > "2014-06-01 00:00:00", DateTimeUTC < '2015-05-31 23:59:59') # keep in mind that this is all in UTC still
fp_wst14 <- fishpaths(wst14, wst14$TagID, wst14$Station)
fp_wst14 <- fp_wst14 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_wst14$residence) <- "days"
fp_wst14 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_wst14 <- fp_wst14 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_wst14$totalres) <- "days"
firstlast_wst14$tagging_group <- "wst14"
meanres_wst14 <- firstlast_wst14 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID)) # works; move to new script to complete calculations
meanres_wst14
# White sturgeon residence in 2015-2016:-----------------
wst15 <- d3 %>%
filter(DateTimeUTC > "2015-06-01 00:00:00", DateTimeUTC < '2016-05-31 23:59:59') # keep in mind that this is all in UTC still
fp_wst15 <- fishpaths(wst15, wst15$TagID, wst15$Station)
fp_wst15 <- fp_wst15 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_wst15$residence) <- "days"
fp_wst15 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_wst15 <- fp_wst15 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_wst15$totalres) <- "days"
firstlast_wst15$tagging_group <- "wst15"
meanres_wst15 <- firstlast_wst15 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID)) # works; move to new script to complete calculations
meanres_wst15
# wst residence
allwst <- rbind(firstlast_wst11, firstlast_wst12, firstlast_wst13, firstlast_wst14, firstlast_wst15)
allwst$Sp = "wst"
ggplot(allwst, aes(x = Sp, y = totalres)) + geom_boxplot(alpha = 0.5) + geom_jitter(aes(color = tagging_group))
# Chinook residence in 2012-2013:
d2 <- filter(d, TagID %in% tags$fca_2012.TagID)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) # make sure we don't get any detections for individual fish before they were tagged
chn12 <- d2 %>%
filter(DateTimeUTC > "2012-06-01 00:00:00", DateTimeUTC < '2013-05-31 23:59:59') # keep in mind that this is all in UTC still
fp_chn12 <- fishpaths(chn12, chn12$TagID, chn12$Station)
fp_chn12 <- fp_chn12 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_chn12$residence) <- "days"
fp_chn12 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_chn12 <- fp_chn12 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_chn12$totalres) <- "days"
firstlast_chn12$tagging_group <- "chn12"
meanres_chn12 <- firstlast_chn12 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID))
meanres_chn12
# Chinook residence in 2013-2014
d2 <- filter(d, TagID %in% tags$fca_2013.TagID)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
ungroup() # make sure we don't get any detections for individual fish before they were tagged; filters out 702 detections
chn13 <- d2 %>%
filter(DateTimeUTC > "2013-06-01 00:00:00", DateTimeUTC < '2014-05-31 23:59:59') %>%
arrange(DateTimeUTC)# keep in mind that this is all in UTC still
fp_chn13 <- fishpaths(chn13, chn13$TagID, chn13$Station)
fp_chn13 <- fp_chn13 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_chn13$residence) <- "days"
fp_chn13 <- fp_chn13 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_chn13 <- fp_chn13 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_chn13$totalres) <- "days"
firstlast_chn13$tagging_group <- "chn13"
meanres_chn13 <- firstlast_chn13 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID))
meanres_chn13
# Chinook residence in 2014-2015-----------------
d2 <- filter(d, TagID %in% tags$fca_2014.TagID)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
ungroup() # make sure we don't get any detections for individual fish before they were tagged
chn14 <- d2 %>%
filter(DateTimeUTC > "2014-06-01 00:00:00", DateTimeUTC < '2015-05-31 23:59:59') %>%
arrange(DateTimeUTC)# keep in mind that this is all in UTC still
fp_chn14 <- fishpaths(chn14, chn14$TagID, chn14$Station)
fp_chn14 <- fp_chn14 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_chn14$residence) <- "days"
fp_chn14 <- fp_chn14 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_chn14 <- fp_chn14 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_chn14$totalres) <- "days"
firstlast_chn14$tagging_group <- "chn14"
meanres_chn14 <- firstlast_chn14 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID))
meanres_chn14
ggplot(fp_chn14, aes(x = departure, y = Station)) + geom_point(aes(color = factor(TagID))) # so the problem is that separately, none of the encounters are more than 7 days, but cumulatively, there's still definnitely a couple of potential shed tags.  Will need to come up with a better, more subtle filter for this down the road.  # GIT ISSUE
# Chinook residence in 2015-2016 ------------------------------
d2 <- filter(d, TagID %in% tags$fca_2015.TagID)
d2 <- d2 %>%
group_by(TagID) %>%
filter(DateTimeUTC >= DateTagged) %>%
ungroup() # make sure we don't get any detections for individual fish before they were tagged
chn15 <- d2 %>%
filter(DateTimeUTC > "2015-06-01 00:00:00", DateTimeUTC < '2016-05-31 23:59:59') %>%
arrange(DateTimeUTC)# keep in mind that this is all in UTC still
fp_chn15 <- fishpaths(chn15, chn15$TagID, chn15$Station)
fp_chn15 <- fp_chn15 %>%
arrange(arrival) %>%
mutate(residence = departure - arrival)
units(fp_chn15$residence) <- "days"
fp_chn15 <- fp_chn15 %>%
filter(residence <= 7) # filter out encounters equal to or longer than 7 consecutive days
firstlast_chn15 <- fp_chn15 %>%
group_by(TagID) %>%
summarise(firstarrival = min(arrival), lastdeparture = max(departure)) %>%
mutate(totalres = lastdeparture - firstarrival)
units(firstlast_chn15$totalres) <- "days"
firstlast_chn15$tagging_group <- "chn15"
meanres_chn15 <- firstlast_chn15 %>%
summarise(meanres = mean(totalres), sdres = sd(totalres), n = len(TagID))
meanres_chn15
ggplot(fp_chn15, aes(x = departure, y = Station)) + geom_point(aes(color = factor(TagID)))
chn <- rbind(firstlast_chn12, firstlast_chn13, firstlast_chn14, firstlast_chn15)
chn$Sp <- "chn"
residency <- rbind(allwst, chn)
res_completeyears <- filter(residency, tagging_group != "wst11", tagging_group != "chn12")
g <- ggplot(res_completeyears, aes(x = Sp, y = totalres)) + geom_boxplot(alpha = 0.6) + geom_jitter(aes(color = tagging_group))
g + labs(title = "Residency in Yolo Bypass by Species", x = "Species", y = "Residence in Days")
g <- ggplot(res_completeyears, aes(x = Sp, y = totalres)) + geom_boxplot(alpha = 0.6) + geom_jitter(aes(color = Sp))
g + labs(title = "Residency in Yolo Bypass by Species", x = "Species", y = "Residence in Days")
g <- ggplot(res_completeyears, aes(x = Sp, y = totalres)) + geom_boxplot(alpha = 0.6) + geom_jitter(aes(color = Sp), size = 2, alpha = 0.7)
g + labs(title = "Residency in Yolo Bypass by Species", x = "Species", y = "Residence in Days")
# Circular bar plot
library(ggplot2)
# data has to look like: group = chn or wst, value = percentage of the year that they're present.
# most white sturgeon present from late October - early April.
# wst
julian(as.Date("2016-10-25"), origin = as.Date("2016-01-01")) #298
julian(as.Date("2016-04-08"), origin = as.Date("2016-01-01")) #98
298-98 # missing for 200 days out of the summer
365.25-298 # 67.25
67.25+98 # present for 165.25 days
165.25/365.25 # present for 45% of the year
#chn
julian(as.Date("2016-01-08"), origin = as.Date("2016-01-01")) #7
julian(as.Date("2016-09-05"), origin = as.Date("2016-01-01")) #98
365.25-248 # present for 117.25 + 7 days = 124.25 days
124.25/365.25
# present for 34% of the year
d <- data.frame(group = c("chn", "wst"), percentage = c(34, 45))
ggplot(d, aes(x = group, y = percentage ,fill = group)) +
geom_bar(width = 0.85, stat="identity") +
# To use a polar plot and not a basic barplot
coord_polar(theta = "y") +
#Remove useless labels of axis
xlab("") + ylab("")  + ylim(c(0, 100))
library(ybp)
library(fishtrackr)
library(tidyverse)
a <- alltags
groups <- split(a, a$`Tagging Group`)
g <- map(groups, select, TagID) # selects only the TagID column of each dataframe
tags <- unlist(g, recursive = FALSE) # have to unlist the first level to be able to manipulate with these as vectors
d <- all69khz_grouped # all detections, with grouped gated receivers
d <- filter(d, TagID %in% tags$wst_2014.TagID)
d <- filter(d, DateTimeUTC > "2013-07-01", DateTimeUTC < "2014-06-30")
d <- filter(d, DateTimeUTC > "2014-07-01", DateTimeUTC < "2015-06-30") # d now contains white sturgeon in detyear 2014
d <- all69khz_grouped # all detections, with grouped gated receivers
d <- filter(d, TagID %in% tags$wst_2014.TagID)
d <- filter(d, DateTimeUTC > "2014-07-01", DateTimeUTC < "2015-06-30") # d now contains white sturgeon in detyear 2014
d2 <- fishpaths(d, d$TagID, d$Station)
d2$residence = d2$departure - d2$arrival
units(d2$residence) <- "hours"
resbystation <- d2 %>%
group_by(TagID, Station) %>%
mutate(meanres = mean(residence)) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station))
resbystation
24*7
resbystation <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(., aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station))
resbystation
resbystation <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station)) + theme(legend.position = "none")
resbystation
resbystation <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station)) + geom_jitter(width = 0.5) + theme(legend.position = "none")
resbystation
resbystation <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station)) + geom_jitter(aes(color = Station), alpha = 0.5, width = 0.5) + theme(legend.position = "none")
resbystation
d <- all69khz_grouped # all detections, with grouped gated receivers
d <- filter(d, TagID %in% tags$fca_2014.TagID)
d <- filter(d, DateTimeUTC > "2014-07-01", DateTimeUTC < "2015-06-30") # d now contains white sturgeon in detyear 2014
d2 <- fishpaths(d, d$TagID, d$Station)
d2$residence = d2$departure - d2$arrival
units(d2$residence) <- "hours"
resbystation_chn <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station)) + geom_jitter(aes(color = Station), alpha = 0.5, width = 0.5) + theme(legend.position = "none") + labs(title = "White Sturgeon Mean Residency in Hours by Station")
resbystation_chn
resbystation_chn <- d2 %>%
filter(residence < 150) %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_boxplot(aes(color = Station)) + geom_jitter(aes(color = Station), alpha = 0.5, width = 0.5) + theme(legend.position = "none") + labs(title = "Chinook Salmon Mean Residency in Hours by Station")
resbystation_chn
resbystation
par(mfrow = c(2, 1))
resbystation
resbystation_chn
range(d2$residence)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
group_by(TagID, Station) %>%
mutate(meanres = as.numeric(mean(residence))) %>%
ungroup() %>%
ggplot(aes(x = Station, y = meanres)) + geom_point(aes(color = factor(TagID)), size = 2, alpha = 0.5)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = meanres)) + geom_point(aes(color = factor(TagID)), size = 2, alpha = 0.5)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_point(aes(color = factor(TagID)), size = 2, alpha = 0.5)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = factor(TagID)), size = 2, alpha = 0.5) + facet_wrap(~factor(TagID))
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = factor(TagID)), size = 2, alpha = 0.5) + geom_jitter(aes(color = factor(TagID)), alpha = 0.5, size = 2) + facet_wrap(~TagID)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = factor(TagID)), alpha = 0.5) + geom_jitter(aes(color = factor(TagID)), alpha = 0.5, size = 2) + facet_wrap(~TagID)
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = factor(TagID)), alpha = 0.5) + geom_jitter(aes(color = factor(TagID)), alpha = 0.5, size = 2) + facet_wrap(~TagID) + labs(title = "Residence Time (hrs) of Chinook at locations with barriers", x = "2014")
d <- all69khz_grouped # all detections, with grouped gated receivers
d <- filter(d, TagID %in% tags$wst_2014.TagID)
d <- filter(d, DateTimeUTC > "2014-07-01", DateTimeUTC < "2015-06-30") # d now contains white sturgeon in detyear 2014
d2 <- fishpaths(d, d$TagID, d$Station)
d2$residence = d2$departure - d2$arrival
units(d2$residence) <- "hours"
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = factor(TagID)), alpha = 0.5) + geom_jitter(aes(color = factor(TagID)), alpha = 0.5, size = 2) + facet_wrap(~TagID) + labs(title = "Residence Time (hrs) of White Sturgeon at locations with barriers", x = "2014")
d <- all69khz_grouped # all detections, with grouped gated receivers
d <- filter(d, TagID %in% tags$wst_2014.TagID | TagID %in% tags$fca_2014.TagID)
len(d$TagID)
d <- filter(d, DateTimeUTC > "2014-07-01", DateTimeUTC < "2015-06-30") # d now contains white sturgeon in detyear 2014
d2 <- fishpaths(d, d$TagID, d$Station)
d2$residence = d2$departure - d2$arrival
units(d2$residence) <- "hours"
d2 %>%
filter(residence < 150, residence > 0, Station == "Lisbon" | Station == "Swanston") %>%
ggplot(aes(x = Station, y = residence)) + geom_boxplot(aes(color = Station), alpha = 0.5) + geom_jitter(aes(color = factor(TagID)), alpha = 0.5, size = 2) + facet_wrap(~Sp) + labs(title = "Residence Time (hrs) of Chinook at locations with barriers")
d2 %>%
filter(residence < 150, residence > 0, TagID == 46640)
w46440 <- d2 %>%
filter(residence < 150, residence > 0, TagID == 46640)
View(w46440)
